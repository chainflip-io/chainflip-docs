---

title: Affiliates

description: Affiliates is a feature which allows brokers to share commission.

---

import { Callout } from "@/components";

# Affiliates
<Callout type="info">In version 1.8 we change the way Affiliate brokers work. We stay backward compatible with the previous version, and it is possible to withdraw your Affiliate commissions via the regular withdrawal flow for old Affiliate Broker accounts.</Callout>

## Terminology

To begin with, let's define the following terms to be on the same page when talking about Affiliates:

- **Broker**: A Chainflip account running the Broker API bundle and is able to communicate with the Chainflip state-chain.
- **Affiliate**: A Chainflip account derived from a Broker account and managed by this particular Broker account that is not able to directly interact with the Chainflip state-chain.
- **Beneficiary**: A Chainflip account that receives a share of a commission.

## Affiliate account

You can think of an Affiliate as a "passive-sub-account" no one has the private-key to and which is not required/able to interact with the 
Chainflip state-chain directly. This feature allows Affiliates to request Swap Deposit Channels through a Broker API provider, in exchange for a share of commission.

An Affiliate is getting created other the Broker API of a Broker and is managed by this Broker account over the entire lifetime of the Affiliate. 
During the registration of an Affiliate, it's required to set up a constant and not changeable withdrawal address. This withdrawal address is the trustless component between the Affiliate and the Broker.
To learn how to register an Affiliate, please check out the [Broker API documentation](broker-api#broker_register_affiliate).

The goal of this feature is to deliver a frictionless way to share commission with other parties that don't want to run a Broker API bundle themselves, but still want to benefit from the operation of a Broker by bringing them swaps and sharing the fees.

<Callout type="warning">
Only the Broker account that created an Affiliate can trigger the withdrawal of the Affiliate's collected commissions. If the Broker account is losing the access to its own account, the Affiliate's commission can not be withdrawn anymore.
</Callout>

After the Affiliate has been created, you as the Affiliate should verify the withdrawal address by running the following command against the Chainflip node of your trust:

```bash
curl -H "Content-Type: application/json" -d '{"jsonrpc":"2.0","id":1,"method":"cf_get_affiliate_account_details","params": ["BROKER_ACCOUNT_ID", "AFFILIATE_ACCOUNT_ID"]}' https://mainnet-rpc.chainflip.io
```

This will return the details of the Affiliate account, including the withdrawal address.

```json
{"jsonrpc":"2.0","result":{"short_id":0,"withdrawal_address":"0x3499b9b27ec38fe019299498958c451d294f6b5e"},"id":1}
```

With this, you ensure that the withdrawal address is correctly setup and your funds are safu!

## How the share of commission works

When a Broker, running the Broker API bundle, opens a Swap Deposit Channel, they can optionally specify a list of up to five (5) additional *Beneficiaries*, in addition to their own commission.

This commission can be set at the time of deposit channel creation, which provides additional flexibility.
Each Beneficiary receives their share out of all successful swaps coming through the deposit channel while it is open.

See the [API documentation](broker-api#broker_request_swap_deposit_address) to learn more about deposit channel management.

### Example

<br />
<img src="/swapping/affiliate_brokers.png" alt="Affiliate Brokers example" />
<br />

In the first example, Broker #1 and Broker #2 are two different Chainflip accounts, separately running the Broker API bundle, and opening Swap Deposit Channels on behalf of users, collecting 100bps in fees on every successful swap.

With Affiliates, Broker #1 is now able to run the Broker API and open Swap Deposit Channels with Affiliate #2 as the Beneficiary, each collecting 50bps in fees on every successful swap.

Brokers are able to set different Affiliates and commission splits on a per-channel basis.

<Callout type="info">
A Beneficiary can be either another Broker or an Affiliate. The only requirement is that the account exists on the Chainflip network to be able to receive the commission.
</Callout>

## Considerations

- Affiliates *must* be created by a corresponding Broker account
- Affiliates are managed by a Broker account
- Affiliates can claim their accrued commissions through their Broker
- Affiliates are not Brokers
- One Broker can be the Beneficiary of another Broker like an Affiliate can